@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage<SearchViewModel>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="search-page">
    <header class="page-header">
        <h1 class="page-title">Search</h1>
    </header>

    <form action="/search" method="get" class="search-page-form" role="search">
        <div class="search-input-wrapper">
            <label for="search-query" class="visually-hidden">Search query</label>
            <input type="search"
                   id="search-query"
                   name="q"
                   value="@Model.Query"
                   placeholder="Search articles..."
                   class="search-page-input"
                   autocomplete="off" />
            <button type="submit" class="search-page-button">
                <svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search</span>
            </button>
        </div>
    </form>

    @if (Model.HasSearched)
    {
        <div class="search-results">
            @if (Model.Result != null)
            {
                <div class="search-summary">
                    <p>
                        Found <strong>@Model.Result.Articles.TotalItems</strong> results for
                        "<strong>@Model.Query</strong>"
                        <span class="search-duration">(in @Model.Result.SearchDuration.TotalMilliseconds.ToString("F0")ms)</span>
                    </p>
                </div>

                @if (Model.Result.RelatedCategories?.Any() == true)
                {
                    <div class="search-filters">
                        <span class="filter-label">Filter by category:</span>
                        <div class="filter-tags">
                            @foreach (var category in Model.Result.RelatedCategories)
                            {
                                <a href="@category.GetUrl()" class="filter-tag">@category.Name</a>
                            }
                        </div>
                    </div>
                }

                @if (Model.Result.Articles.Items.Any())
                {
                    ViewData["SectionTitle"] = "Search Results";
                    ViewData["ShowPagination"] = true;
                    ViewData["BaseUrl"] = $"/search?q={Uri.EscapeDataString(Model.Query)}";
                    @await Html.PartialAsync("Partials/_LatestList", Model.Result.Articles)
                }
                else
                {
                    <div class="no-results">
                        <p class="no-results-message">No articles found matching your search.</p>
                        <p class="no-results-suggestions">Try different keywords or browse our categories.</p>
                    </div>
                }
            }
        </div>
    }
    else
    {
        <div class="search-prompt">
            <p>Enter a search term to find articles.</p>
        </div>
    }
</div>
