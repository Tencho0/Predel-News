@model IReadOnlyList<CategoryBlock>
<section class="category-blocks-section">
    @foreach (var block in Model)
    {
        <div class="category-block">
            <header class="category-block-header">
                <h2 class="category-block-title">
                    <a href="@block.Category.GetUrl()">@block.Category.Name</a>
                </h2>
                <a href="@block.Category.GetUrl()" class="category-block-more">
                    View all
                    <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </a>
            </header>

            @if (block.Articles.Any())
            {
                var featuredArticle = block.Articles.First();
                var otherArticles = block.Articles.Skip(1).Take(3).ToList();

                <div class="category-block-content">
                    <article class="category-block-featured">
                        <a href="@featuredArticle.GetUrl()" class="category-article-link">
                            @if (featuredArticle.FeaturedImage != null)
                            {
                                <figure class="category-article-image">
                                    <img src="@featuredArticle.FeaturedImage.GetCropUrl(400, 250)"
                                         alt="@(featuredArticle.FeaturedImage.AltText ?? featuredArticle.Title)"
                                         width="400"
                                         height="250"
                                         loading="lazy" />
                                </figure>
                            }
                            <h3 class="category-article-title">@featuredArticle.Title</h3>
                            @if (!string.IsNullOrEmpty(featuredArticle.Excerpt))
                            {
                                <p class="category-article-excerpt">@featuredArticle.Excerpt</p>
                            }
                            <time datetime="@featuredArticle.PublishDate.ToString("yyyy-MM-ddTHH:mm:ss")" class="category-article-date">
                                @featuredArticle.PublishDate.ToString("d MMM yyyy", new System.Globalization.CultureInfo("bg-BG"))
                            </time>
                        </a>
                    </article>

                    @if (otherArticles.Any())
                    {
                        <div class="category-block-list">
                            @foreach (var article in otherArticles)
                            {
                                <article class="category-block-item">
                                    <a href="@article.GetUrl()" class="category-item-link">
                                        @if (article.FeaturedImage != null)
                                        {
                                            <figure class="category-item-image">
                                                <img src="@article.FeaturedImage.GetCropUrl(100, 75)"
                                                     alt="@(article.FeaturedImage.AltText ?? article.Title)"
                                                     width="100"
                                                     height="75"
                                                     loading="lazy" />
                                            </figure>
                                        }
                                        <div class="category-item-content">
                                            <h4 class="category-item-title">@article.Title</h4>
                                            <time datetime="@article.PublishDate.ToString("yyyy-MM-ddTHH:mm:ss")" class="category-item-date">
                                                @article.PublishDate.ToString("d MMM", new System.Globalization.CultureInfo("bg-BG"))
                                            </time>
                                        </div>
                                    </a>
                                </article>
                            }
                        </div>
                    }
                </div>
            }
        </div>
    }
</section>
